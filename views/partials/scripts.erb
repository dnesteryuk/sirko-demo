<script src="bower_components/jquery/dist/jquery.min.js"></script>
<script src="bower_components/bootstrap/dist/js/bootstrap.min.js"></script>

<script>
  $(function() {
    /**
     * the code below shows a predicted path in a link once the sirko client
     * gets the prediction. Doing that, the user can follow the predicted path
     * in order to see how the pre-rendering feature is useful.
     */
    var printPrediction = function(prediction) {
      var a = document.getElementById('predicted_path');

      if (prediction !== '') {
        a.setAttribute('href', prediction);
        a.innerHTML = prediction;
      }
      else {
        a.innerHTML = 'No prediction for this page';
      }
    };

    sirko('predicted', function(prediction, isPrevCorrect) {
      printPrediction(prediction);

      if (isPrevCorrect !== undefined) {
        console.info('The previous prediction was', isPrevCorrect ? 'correct' : 'incorrect');
      }
      else {
        console.info('It is a first visit\n or there isn\'t a prediction for the previous request\n or the page got refreshed');
      }

       // track correctness of predictions via Mixpanel
      <% if mixpanel_token %>
        if (isPrevCorrect !== undefined) {
          var correctness = isPrevCorrect ? 'correct' : 'incorrect';

          console.info('Send to the mixpanel:', correctness);

          mixpanel.track("sirko-prediction-" + correctness, {prediction: prediction});
        }
      <% end %>
    });
  });
</script>
